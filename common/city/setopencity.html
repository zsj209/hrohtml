<style>.opencity_btn {}.opencity_btn input[type=button] {width: 100px;}.border_test{border:solid 1px red;}.ui-jqCTree-form {font-size: 14px;line-height: 20px; border: 1px solid #a6c9e2; float:left; overflow:auto;}UL.jqCTree, UL.jqCTree * {list-style-type: none; margin:0; padding: 0 0 5px 0; line-height: 20px;}UL.jqCTree LI {padding: 4px 0 0 0;}UL.jqCTree LI UL {padding: 0 0 0 20px; margin: 0;}UL.jqCTree LABEL {cursor: pointer; padding: 2px 0; }UL.jqCTree LABEL.hover {color: #FF0000;}UL.jqCTree LI .arrow{width: 20px; height: 20px; padding: 0; margin: 0 0 0 3px; cursor: pointer; float: left; background: transparent no-repeat 0 4px;}UL.jqCTree LI .collapsed {background-image: url(../css/images/tree/collapsed.gif);}UL.jqCTree LI .expanded {background-image: url(../css/images/tree/expanded.gif);}UL.jqCTree LI .checkbox {width: 20px; height: 18px; padding: 0; margin: 0; cursor: pointer; float: left; background: url(../css/images/tree/check0.gif) no-repeat 0 0px;}UL.jqCTree LI .checked {background-image: url(../css/images/tree/check2.gif);}UL.jqCTree LI .half_checked {background-image: url(../css/images/tree/check1.gif);}</style><script type="text/javascript" src="../js/jqCTree.js"></script><script type="text/javascript">	$(function() {		var params = {			_mt : "commoncityinvalid.getcityforset",			rootcompanyid: "1",			curcompanyid : "1000"		};		var payload = {			data : params,			level : "UserLogin"		};		var data = encrypt(payload.level, payload.data);		console.log(data._sig + "--data");		//comAlert("aaa");		$.ajax({			type : "POST",			url : pubsources.pub_getlink,			dataType : "json",			xhrFields : {				withCredentials : true			},			data : serialize(data),			success : function(result) {				if (getStatus(result)) {					console.log(result);					//comAlert(result.content["0"].value[0].cityCode);					var citylist = result.content["0"].value, sb = [], sbs = [];					sb.push("<ul class=\"jqCTree\">");					$.each(citylist,function(){						sbs.push(String.format("<li class=\"%s\">", this.setstyle));						sbs.push(String.format("<input type=\"checkbox\" id=\"%s\" pnode=\"%s\" node=\"%s\">", this.cityId, this.cityPcode, this.cityCode));						sbs.push(String.format("<label>%s</label>", this.CityName));						if (this.sublist.length > 0) {							sbs.push(String.format("<ul>%s</ul>", this.sublist));						}						sbs.push("</li>");						var tmpcode = "["+this.cityId+"]", tmpsb = sb.join("");						if (tmpsb.indexOf(tmpcode)>-1) {							var tmps = tmpsb.replace(tmpcode, sbs.join(""));							sb = [];							sb.push(tmps);						} else {							sb.push(sbs.join(""));						}						sbs = [];					});					sb.push("</ul>");					//alert("before-----:"+sb.join(""));					$("#opencity_tree").html(sb.join(""));					var t = $("ul.jqCTree").jqCTree({});					//alert("after-----:"+$("#opencity_tree").html());					t.oneExpand();					$("#btn_opencity_expand").bind("click", t.oneExpand);					$("#btn_opencity_collaps").bind("click", t.oneCollaps);					$("#btn_opencity_selall").bind("click", t.selectAll);						$("#btn_opencity_reset").bind("click", t.reset);							$("#btn_opencity_preview").bind("click", function(){						$("#selall").attr("disabled","disabled");		 				$("#reset").attr("disabled","disabled");		 				$("#continue").attr("disabled","");		 				t.preview();					});					$("#btn_opencity_continue").bind("click", function() {		 				$("#selall").attr("disabled","");		 		  		$("#reset").attr("disabled","");		 				$("#continue").attr("disabled","disabled");		 				t.continues();				 			});										$("#btn_opencity_save").bind("click",function() {		 				var vals = "";		 				t.getChecked().each(function() {		 					if($(this).attr("node") > 0) {		 						vals += $(this).attr("id") + ",";		 					}		 				});		 				//comAlert(vals);		 				if (vals.length >= 1) {		 					vals = vals.substring(0, vals.length - 1);		 				}		 				//comAlert(vals);		 				if(vals.length > 0) {		 					opencity_save(vals);		 				} else {		 					comAlert("请选择开通城市！")		 				}					});										//测试选择开通城市					$("#btn_test_selopencity").click(						function() {							var selpara = {seltype:"selopencity", seltitle:"选择开通城市", rtnvalobj:"test_selopencity", rtndisobj:"dis_test_selopencity", discol:1, flparams:"companyid", flparamvs:"1000"};							comsel(selpara);					}) ;									} else if (result.stat.stateList["0"].code=="3018") {					$("#opencity_tree").val("请先维护基础城市信息！");				} else if (result.stat.stateList["0"].code=="3019") {					$("#opencity_tree").val("系统错误，轻语系统管理员联系！");				}			},			error : function() {				$("#opencity_tree").val("抱歉，网络故障或服务器繁忙，请检查您的网络环境或稍后重试。");			}		});	});		function opencity_save(citys){		//comAlert("opencity_save: " + citys);		var params = {				_mt : "commoncityinvalid.saveinvcity",				rootcompanyid: "1",				curcompanyid : "1000",				cityids : citys			};		var payload = {			data : params,			level : "UserLogin"		};		var data = encrypt(payload.level, payload.data);		console.log(data._sig + "--data");		//comAlert("aaa");		$.ajax({			type : "POST",			url : pubsources.pub_getlink,			dataType : "json",			xhrFields : {				withCredentials : true			},			data : serialize(data),			success : function(result) {				if (getStatus(result)) {					console.log(result);					comAlert("保存成功!");				}			},			error : function() {				comAlert("抱歉，网络故障或服务器繁忙，请检查您的网络环境或稍后重试。");			}		});	}</script><div style="margin-left:5px;margin-top:5px;">	<div style="width:98%;height:30px;">		<span>设置开通城市</span>	</div>	<div style="width:98%;height:500px;" class="">		<div id="opencity_tree" style="width:400px;height:100%;float:left;" class="ui-jqCTree-form"></div>		<div style="float:left;margin-left:50px;margin-top:50px;" class="opencity_btn">			<input type="button" id="btn_opencity_expand" value="展   开"><br/><br/>			<input type="button" id="btn_opencity_collaps" value="收  缩"><br/><br/>			<input type="button" id="btn_opencity_selall" value="全  选"><br/><br/>			<input type="button" id="btn_opencity_reset" value="重  置"><br/><br/>			<input type="button" id="btn_opencity_preview" value="预  览"><br/><br/>			<input type="button" id="btn_opencity_continue" value="继  续"><br/><br/>			<input type="button" id="btn_opencity_save" value="保  存">			<br/>			<!--  			<input type="text" id="test_selopencity" value=""><br/>			<input type="text" id="dis_test_selopencity" value=""><br/>			<input type="button" id="btn_test_selopencity" value="选择开通城市">			-->					</div>	</div></div>